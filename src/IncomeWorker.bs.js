// Generated by BUCKLESCRIPT VERSION 2.2.3, PLEASE EDIT WITH CARE
'use strict';

var $$Array = require("bs-platform/lib/js/array.js");
var Utils = require("./utils/Utils.bs.js");
var Json_decode = require("bs-json/src/Json_decode.js");
var SmartbitClient = require("./application/wallet/SmartbitClient.bs.js");

function _encodeToSend(param) {
  if (param) {
    return {
            type: "MonitorAddresses",
            toMonitor: param[0],
            knownTxIds: param[1]
          };
  } else {
    return {
            type: "Wait",
            toMonitor: /* array */[],
            knownTxIds: /* array */[]
          };
  }
}

function _decodeToReceived(message) {
  return /* NewTransactionsDetected */[$$Array.to_list(Json_decode.array(SmartbitClient.decodeTransaction, message.data))];
}

var Message = /* module */[
  /* _encodeToSend */_encodeToSend,
  /* _decodeToReceived */_decodeToReceived
];

function postMessage(worker, message) {
  worker.postMessage(_encodeToSend(message));
  return /* () */0;
}

var workerPath = "/incomeWorker.js";

function make(onMessage) {
  var worker = new Worker(workerPath);
  worker.onmessage = (function (param) {
      return Utils.$great$great(_decodeToReceived, onMessage, param);
    });
  return worker;
}

exports.Message = Message;
exports.postMessage = postMessage;
exports.workerPath = workerPath;
exports.make = make;
/* Utils Not a pure module */
