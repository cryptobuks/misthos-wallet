// Generated by BUCKLESCRIPT VERSION 2.2.3, PLEASE EDIT WITH CARE
'use strict';

var List = require("bs-platform/lib/js/list.js");
var Block = require("bs-platform/lib/js/block.js");
var Curry = require("bs-platform/lib/js/curry.js");
var Policy = require("../application/Policy.bs.js");
var WalletTypes = require("../application/wallet/WalletTypes.bs.js");
var PrimitiveTypes = require("../application/PrimitiveTypes.bs.js");
var AccountKeyChain = require("../application/wallet/AccountKeyChain.bs.js");

function make() {
  return /* record */[
          /* name */"",
          /* partners : [] */0,
          /* prospects : [] */0,
          /* removalProspects : [] */0,
          /* metaPolicy */Policy.absolute,
          /* partnerPolicy */Policy.absolute,
          /* incomeAddresses : [] */0,
          /* payouts : [] */0
        ];
}

function apply($$event, state) {
  switch ($$event.tag | 0) {
    case 0 : 
        var match = $$event[0];
        var metaPolicy = match[/* metaPolicy */4];
        return /* record */[
                /* name */match[/* ventureName */1],
                /* partners */state[/* partners */1],
                /* prospects */state[/* prospects */2],
                /* removalProspects */state[/* removalProspects */3],
                /* metaPolicy */metaPolicy,
                /* partnerPolicy */metaPolicy,
                /* incomeAddresses */state[/* incomeAddresses */6],
                /* payouts */state[/* payouts */7]
              ];
    case 1 : 
        var match$1 = $$event[0];
        var newrecord = state.slice();
        newrecord[/* prospects */2] = /* :: */[
          /* record */[
            /* processId */match$1[/* processId */0],
            /* userId */match$1[/* data */4][/* id */0],
            /* endorsedBy : :: */[
              match$1[/* supporterId */2],
              /* [] */0
            ]
          ],
          state[/* prospects */2]
        ];
        return newrecord;
    case 2 : 
        var match$2 = $$event[0];
        var supporterId = match$2[/* supporterId */1];
        var processId = match$2[/* processId */0];
        var newrecord$1 = state.slice();
        newrecord$1[/* prospects */2] = List.map((function (p) {
                var match = PrimitiveTypes.ProcessId[/* eq */5](p[/* processId */0], processId);
                if (match !== 0) {
                  return /* record */[
                          /* processId */p[/* processId */0],
                          /* userId */p[/* userId */1],
                          /* endorsedBy : :: */[
                            supporterId,
                            p[/* endorsedBy */2]
                          ]
                        ];
                } else {
                  return p;
                }
              }), state[/* prospects */2]);
        return newrecord$1;
    case 3 : 
        var data = $$event[0][/* data */2];
        var newrecord$2 = state.slice();
        newrecord$2[/* partners */1] = /* :: */[
          /* record */[/* userId */data[/* id */0]],
          state[/* partners */1]
        ];
        newrecord$2[/* prospects */2] = List.filter((function (p) {
                  return PrimitiveTypes.UserId[/* neq */6](p[/* userId */1], data[/* id */0]);
                }))(state[/* prospects */2]);
        return newrecord$2;
    case 4 : 
        var match$3 = $$event[0];
        var newrecord$3 = state.slice();
        newrecord$3[/* removalProspects */3] = /* :: */[
          /* record */[
            /* processId */match$3[/* processId */0],
            /* userId */match$3[/* data */4][/* id */0],
            /* endorsedBy : :: */[
              match$3[/* supporterId */2],
              /* [] */0
            ]
          ],
          state[/* removalProspects */3]
        ];
        return newrecord$3;
    case 5 : 
        var match$4 = $$event[0];
        var supporterId$1 = match$4[/* supporterId */1];
        var processId$1 = match$4[/* processId */0];
        var newrecord$4 = state.slice();
        newrecord$4[/* removalProspects */3] = List.map((function (p) {
                var match = PrimitiveTypes.ProcessId[/* eq */5](p[/* processId */0], processId$1);
                if (match !== 0) {
                  return /* record */[
                          /* processId */p[/* processId */0],
                          /* userId */p[/* userId */1],
                          /* endorsedBy : :: */[
                            supporterId$1,
                            p[/* endorsedBy */2]
                          ]
                        ];
                } else {
                  return p;
                }
              }), state[/* removalProspects */3]);
        return newrecord$4;
    case 6 : 
        var match$5 = $$event[0];
        var id = match$5[/* data */2][/* id */0];
        var processId$2 = match$5[/* processId */0];
        var newrecord$5 = state.slice();
        newrecord$5[/* partners */1] = List.filter((function (p) {
                  return PrimitiveTypes.UserId[/* neq */6](p[/* userId */0], id);
                }))(state[/* partners */1]);
        newrecord$5[/* removalProspects */3] = List.filter((function (p) {
                  return PrimitiveTypes.ProcessId[/* neq */6](p[/* processId */0], processId$2);
                }))(state[/* removalProspects */3]);
        return newrecord$5;
    case 9 : 
        var newrecord$6 = state.slice();
        newrecord$6[/* incomeAddresses */6] = /* :: */[
          /* tuple */[
            $$event[0][/* data */2][/* accountIdx */0],
            /* [] */0
          ],
          /* [] */0
        ];
        return newrecord$6;
    case 16 : 
        var match$6 = $$event[0];
        var newrecord$7 = state.slice();
        newrecord$7[/* payouts */7] = /* :: */[
          /* record */[
            /* processId */match$6[/* processId */0],
            /* payoutTx */match$6[/* data */4][/* payoutTx */1],
            /* endorsedBy : :: */[
              match$6[/* supporterId */2],
              /* [] */0
            ],
            /* status : PayoutPending */0
          ],
          state[/* payouts */7]
        ];
        return newrecord$7;
    case 17 : 
        var match$7 = $$event[0];
        var supporterId$2 = match$7[/* supporterId */1];
        var processId$3 = match$7[/* processId */0];
        var newrecord$8 = state.slice();
        newrecord$8[/* payouts */7] = List.map((function (p) {
                var match = PrimitiveTypes.ProcessId[/* eq */5](p[/* processId */0], processId$3);
                if (match !== 0) {
                  return /* record */[
                          /* processId */p[/* processId */0],
                          /* payoutTx */p[/* payoutTx */1],
                          /* endorsedBy : :: */[
                            supporterId$2,
                            p[/* endorsedBy */2]
                          ],
                          /* status */p[/* status */3]
                        ];
                } else {
                  return p;
                }
              }), state[/* payouts */7]);
        return newrecord$8;
    case 20 : 
        var match$8 = $$event[0];
        var transactionId = match$8[/* transactionId */1];
        var processId$4 = match$8[/* processId */0];
        var newrecord$9 = state.slice();
        newrecord$9[/* payouts */7] = List.map((function (p) {
                var match = PrimitiveTypes.ProcessId[/* eq */5](p[/* processId */0], processId$4);
                if (match !== 0) {
                  return /* record */[
                          /* processId */p[/* processId */0],
                          /* payoutTx */p[/* payoutTx */1],
                          /* endorsedBy */p[/* endorsedBy */2],
                          /* status : PayoutCompleted */Block.__(0, [transactionId])
                        ];
                } else {
                  return p;
                }
              }), state[/* payouts */7]);
        return newrecord$9;
    case 22 : 
        var match$9 = $$event[0];
        var errorMessage = match$9[/* errorMessage */1];
        var processId$5 = match$9[/* processId */0];
        var newrecord$10 = state.slice();
        newrecord$10[/* payouts */7] = List.map((function (p) {
                var match = PrimitiveTypes.ProcessId[/* eq */5](p[/* processId */0], processId$5);
                if (match !== 0) {
                  return /* record */[
                          /* processId */p[/* processId */0],
                          /* payoutTx */p[/* payoutTx */1],
                          /* endorsedBy */p[/* endorsedBy */2],
                          /* status : PayoutFailed */Block.__(1, [errorMessage])
                        ];
                } else {
                  return p;
                }
              }), state[/* payouts */7]);
        return newrecord$10;
    case 25 : 
        var match$10 = $$event[0];
        var accountIdx = Curry._1(AccountKeyChain.Address[/* Coordinates */0][/* accountIdx */6], match$10[/* coordinates */0]);
        var newrecord$11 = state.slice();
        newrecord$11[/* incomeAddresses */6] = /* :: */[
          /* tuple */[
            accountIdx,
            /* :: */[
              match$10[/* address */1],
              List.assoc(accountIdx, state[/* incomeAddresses */6])
            ]
          ],
          state[/* incomeAddresses */6]
        ];
        return newrecord$11;
    default:
      return state;
  }
}

function partners(state) {
  return state[/* partners */1];
}

function prospects(state) {
  return state[/* prospects */2];
}

function removalProspects(state) {
  return state[/* removalProspects */3];
}

function ventureName(state) {
  return state[/* name */0];
}

function incomeAddresses(state) {
  return List.assoc(WalletTypes.AccountIndex[/* default */8], state[/* incomeAddresses */6]);
}

function payouts(state) {
  return state[/* payouts */7];
}

exports.make = make;
exports.apply = apply;
exports.partners = partners;
exports.prospects = prospects;
exports.removalProspects = removalProspects;
exports.ventureName = ventureName;
exports.incomeAddresses = incomeAddresses;
exports.payouts = payouts;
/* Policy Not a pure module */
