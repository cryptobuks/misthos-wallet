// Generated by BUCKLESCRIPT VERSION 2.1.0, PLEASE EDIT WITH CARE
'use strict';

var Block       = require("bs-platform/lib/js/block.js");
var Curry       = require("bs-platform/lib/js/curry.js");
var React       = require("react");
var Session     = require("./session.js");
var Projects    = require("./components/projects.js");
var ReasonReact = require("reason-react/lib/js/src/reasonReact.js");

((require('./app.css')));

var component = ReasonReact.reducerComponent("App");

function make() {
  var newrecord = component.slice();
  newrecord[/* didMount */4] = (function (param) {
      var match = param[/* state */4][/* session */0];
      if (typeof match === "number" && match !== 0) {
        return /* SideEffects */Block.__(2, [(function (param) {
                      var reduce = param[/* reduce */3];
                      Session.completeLogIn(/* () */0).then((function (session) {
                              return Promise.resolve(Curry._2(reduce, (function () {
                                                return /* LoginCompleted */[session];
                                              }), /* () */0));
                            }));
                      return /* () */0;
                    })]);
      } else {
        return /* NoUpdate */0;
      }
    });
  newrecord[/* render */9] = (function (param) {
      var state = param[/* state */4];
      var reduce = param[/* reduce */3];
      var match = state[/* session */0];
      var header = typeof match === "number" ? (
          match !== 0 ? "Waiting for login to complete" : "Welcome To Misthos"
        ) : "Hello " + match[0][/* userName */0];
      var match$1 = state[/* session */0];
      var match$2 = state[/* session */0];
      return React.createElement("div", undefined, React.createElement("h1", undefined, header), typeof match$1 === "number" ? (
                    match$1 !== 0 ? React.createElement("div", undefined) : React.createElement("button", {
                            onClick: Curry._1(reduce, (function () {
                                    return /* SignIn */0;
                                  }))
                          }, "Sign In with Blockstack")
                  ) : React.createElement("button", {
                        onClick: Curry._1(reduce, (function () {
                                return /* SignOut */1;
                              }))
                      }, "SignOut"), typeof match$2 === "number" ? React.createElement("div", undefined) : ReasonReact.element(/* None */0, /* None */0, Projects.make(/* array */[])));
    });
  newrecord[/* initialState */10] = (function () {
      return /* record */[/* session */Session.getCurrentSession(/* () */0)];
    });
  newrecord[/* reducer */12] = (function (action, _) {
      if (typeof action === "number") {
        if (action !== 0) {
          return /* Update */Block.__(0, [/* record */[/* session */Session.signOut(/* () */0)]]);
        } else {
          return /* Update */Block.__(0, [/* record */[/* session */Session.signIn(/* () */0)]]);
        }
      } else {
        return /* Update */Block.__(0, [/* record */[/* session */action[0]]]);
      }
    });
  return newrecord;
}

exports.component = component;
exports.make      = make;
/*  Not a pure module */
