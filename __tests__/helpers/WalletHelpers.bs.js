// Generated by BUCKLESCRIPT VERSION 3.0.0, PLEASE EDIT WITH CARE
'use strict';

var Jest = require("@glennsl/bs-jest/src/jest.js");
var List = require("bs-platform/lib/js/list.js");
var Block = require("bs-platform/lib/js/block.js");
var Address = require("../../src/application/wallet/Address.bs.js");
var Generators = require("./Generators.bs.js");
var WalletTypes = require("../../src/application/wallet/WalletTypes.bs.js");
var PrimitiveTypes = require("../../src/application/PrimitiveTypes.bs.js");
var Venture__Wallet = require("../../src/application/Venture__Wallet.bs.js");

function constructState(log) {
  return Generators.Log[/* reduce */0]((function (s, param) {
                return Venture__Wallet.apply(param[/* event */0], s);
              }), Venture__Wallet.make(/* () */0), log);
}

function testNextIncomeAddress(user, address, wallet) {
  var exposed = Venture__Wallet.exposeNextIncomeAddress(user[/* userId */0], WalletTypes.AccountIndex[/* default */9], wallet);
  var description = "the next address of '" + (PrimitiveTypes.UserId[/* toString */0](user[/* userId */0]) + ("' is '" + (address + "'")));
  Jest.test(description, (function () {
          return Jest.Expect[/* toEqual */12](address, Jest.Expect[/* expect */0](exposed[/* address */1]));
        }));
  return Venture__Wallet.apply(/* IncomeAddressExposed */Block.__(32, [exposed]), wallet);
}

function collectNextTwoAddresses(user, param) {
  var wallet = param[0];
  var exposed1 = Venture__Wallet.exposeNextIncomeAddress(user[/* userId */0], WalletTypes.AccountIndex[/* default */9], wallet);
  var log = Generators.Log[/* appendSystemEvent */7](/* IncomeAddressExposed */Block.__(32, [exposed1]), param[1]);
  var wallet$1 = Venture__Wallet.apply(/* IncomeAddressExposed */Block.__(32, [exposed1]), wallet);
  var exposed2 = Venture__Wallet.exposeNextIncomeAddress(user[/* userId */0], WalletTypes.AccountIndex[/* default */9], wallet$1);
  var log$1 = Generators.Log[/* appendSystemEvent */7](/* IncomeAddressExposed */Block.__(32, [exposed2]), log);
  var wallet$2 = Venture__Wallet.apply(/* IncomeAddressExposed */Block.__(32, [exposed2]), wallet$1);
  return /* tuple */[
          /* tuple */[
            exposed1,
            exposed2
          ],
          /* tuple */[
            wallet$2,
            log$1
          ]
        ];
}

function getExposedAddresses(param) {
  var accountKeyChains = param[/* txInputCollector */3][/* keyChains */3];
  return List.map((function (a) {
                return a[/* address */5];
              }), List.map((function (coordinates) {
                    return Address.find(coordinates, accountKeyChains);
                  }), param[/* exposedCoordinates */5]));
}

var Wallet = 0;

var G = 0;

var L = 0;

exports.Wallet = Wallet;
exports.G = G;
exports.L = L;
exports.constructState = constructState;
exports.testNextIncomeAddress = testNextIncomeAddress;
exports.collectNextTwoAddresses = collectNextTwoAddresses;
exports.getExposedAddresses = getExposedAddresses;
/* Jest Not a pure module */
